# Домашнее задание к занятию «Компоненты Kubernetes»

### Цель задания

Рассчитать требования к кластеру под проект

------

### Инструменты и дополнительные материалы, которые пригодятся для выполнения задания:

- [Considerations for large clusters](https://kubernetes.io/docs/setup/best-practices/cluster-large/),
- [Architecting Kubernetes clusters — choosing a worker node size](https://learnk8s.io/kubernetes-node-size).

------

### Задание. Необходимо определить требуемые ресурсы
Известно, что проекту нужны база данных, система кеширования, а само приложение состоит из бекенда и фронтенда. Опишите, какие ресурсы нужны, если известно:

1. Необходимо упаковать приложение в чарт для деплоя в разные окружения. 
2. База данных должна быть отказоустойчивой. Потребляет 4 ГБ ОЗУ в работе, 1 ядро. 3 копии. 
3. Кеш должен быть отказоустойчивый. Потребляет 4 ГБ ОЗУ в работе, 1 ядро. 3 копии. 
4. Фронтенд обрабатывает внешние запросы быстро, отдавая статику. Потребляет не более 50 МБ ОЗУ на каждый экземпляр, 0.2 ядра. 5 копий. 
5. Бекенд потребляет 600 МБ ОЗУ и по 1 ядру на копию. 10 копий.

----
### Ответ:
1.
   БД - (4 гб + 1 ядро) x 3 = 12 гб + 3 ядра
   КЭШ - (4 гб + 1 ядро) x 3 = 12 гб + 3 ядра
   ФРОНТ - (50 мб + 0,2 ядра) x 5 копий = 250 мб + 1 ядро
   БЭК - (600 мб + 1 ядро) x 10 копий = 6 гб + 10 ядер
   Итого имеем целевую потребность приложения  в - 30,250 гб ОЗУ и 17 ядрах.
   Посчитаем конфигурации для 3 и 4 нод пока без запаса (исходим мз того что будем выделять ресурсы стандартно, кратно 2)
   3 ноды - 12 гб + 6 ядра (Сумарно = 36 гб + 18 ядер)
   4 ноды - 8 гб + 6 ядер (Сумарно = 32 гб + 24 ядра)
   Везде есть перерасход ресурсов.
   Посчитаем необходимое количество ресурсов с запасом. Весь объем запрошенных ресурсов должен поместиться на -1 ноде в зависимости от подхода 3 или 4 ноды. 
   Для 4 нод, минимум будет - 12 гб + 6 ядра на ноду. Сумарно =  48 гб + 24 ядер
   Для 3 нод, минимум будет - 16 гб + 10 ядер на ноду. Сумарно = 52 гб + 30 ядер.
   Конфигурация с 4 нодами выгоднее в данной ситуации.
  
   Для мастер nod определяем такое количество ресурсов на ноду - 4 гб ОЗУ и 2 ядра

  ИТОГ:
       МАСТЕР НОДА
       Количество - 3 шт.
       ОЗУ 1 ноды = 4 гб
       Ядер 1 ноды = 2 ядра
       Сумарно на  3 мастер ноды = 12 гб и  4 ядра.

      РАБОЧИИ НОДЫ
      Количество - 4 шт.
      ОЗУ 1 ноды = 12 гб
      Ядер 1 ноды = 6 ядер
      Сумарно на  3 мастер ноды =  48 гб + 24 ядер
   

### Правила приёма работы

1. Домашняя работа оформляется в своем Git-репозитории в файле README.md. Выполненное домашнее задание пришлите ссылкой на .md-файл в вашем репозитории.
2. Сначала сделайте расчёт всех необходимых ресурсов.
3. Затем прикиньте количество рабочих нод, которые справятся с такой нагрузкой.
4. Добавьте к полученным цифрам запас, который учитывает выход из строя как минимум одной ноды. 
5. Добавьте служебные ресурсы к нодам. Помните, что для разных типов нод требовния к ресурсам разные. 
6. В результате должно быть указано количество нод и их параметры.
